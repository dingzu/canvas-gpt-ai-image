# AI图像生成功能使用指南

## 功能概述

本应用现已集成真正的AI图像生成功能，支持基于画布内容和描述词生成高质量图像。

## 功能特点

### ✨ 智能图像生成
- 📸 自动识别画布内容区域
- 🎨 基于图片标注和描述词生成新图像
- 🚀 实时加载状态显示
- 📱 响应式设计，支持移动端

### 🛠 强大的配置选项
- **质量设置**: 支持自动、高、中、低四种质量选项
- **尺寸选择**: 提供6种常用尺寸规格
  - 512×512 (正方形)
  - 768×512 (横向)
  - 512×768 (纵向)
  - 1024×1024 (高清正方形)
  - 1024×768 (高清横向)
  - 768×1024 (高清纵向)

## 使用步骤

### 1. 设置API密钥

有两种方式配置API密钥：

**方式一：通过环境变量（推荐用于开发）**
1. 在项目根目录创建 `.env` 文件
2. 添加：`VITE_AI_API_KEY=your_actual_api_key`
3. 重启开发服务器

**方式二：应用内设置（推荐用于生产）**
1. 点击工具栏中的 ✨ AI生成按钮
2. 在弹出的密钥设置对话框中输入您的API密钥
3. 点击保存（密钥会自动保存在本地）

> **获取API密钥**: 请访问 https://api.ppinfra.com 注册账户并获取密钥

### 2. 准备画布内容

在画布上创建您想要的内容：

- 📝 添加文字说明
- 🖼 插入参考图片
- 💭 使用气泡工具添加标注
- ✏️ 用画笔绘制草图

### 3. 生成AI图像

1. 确保画布上有内容
2. 点击 ✨ AI生成按钮
3. 在弹窗中：
   - 📖 查看画布预览
   - ✍️ 编辑描述词（默认"根据图片上的标注生成"）
   - ⚙️ 选择图像质量
   - 📐 选择输出尺寸
4. 点击"开始生成"

### 4. 等待生成完成

- 📊 画布上会显示加载矩形，实时显示生成进度
- 🎯 加载完成后，矩形会自动替换为生成的图像
- 🖱 生成的图像支持所有编辑操作（移动、缩放、旋转等）

## 技术规格

### API接口
- **端点**: `https://api.ppinfra.com/v1/images/edits`
- **模型**: gpt-image-1
- **格式**: 支持 PNG、WebP、JPG
- **大小限制**: 单张图片 < 50MB
- **描述词长度**: 最大 32,000 字符

### 生成参数
- **质量选项**: auto、high、medium、low
- **输出格式**: PNG (Base64编码)
- **处理时间**: 通常 10-30 秒

## 组件架构

### 🧩 主要组件

1. **AIGenerateDialog.vue** - AI生成参数设置弹窗
   - 画布预览
   - 描述词编辑
   - 参数配置
   - 生成确认

2. **AILoadingRect.js** - AI加载状态组件
   - 动态加载动画
   - 进度显示
   - 错误处理
   - 图像替换

3. **aiImageService.js** - API服务封装
   - 请求处理
   - 错误管理
   - 进度回调
   - 密钥验证

### 🔄 数据流

```
用户点击AI按钮 → 检查API密钥 → 显示生成弹窗 → 
用户确认参数 → 创建加载矩形 → 调用API服务 → 
显示加载进度 → 接收生成结果 → 替换为图像
```

## 错误处理

### 常见错误及解决方案

1. **API密钥无效**
   - 检查密钥格式是否正确
   - 确认账户余额充足
   - 重新设置API密钥

2. **生成失败**
   - 检查网络连接
   - 确认画布内容符合要求
   - 简化描述词内容

3. **图像加载失败**
   - 刷新页面重试
   - 检查浏览器控制台错误信息

## 最佳实践

### 📋 描述词建议
- 使用清晰、具体的描述
- 包含风格、颜色、构图等关键词
- 避免过于复杂的句子结构

### 🎨 画布准备
- 确保内容布局合理
- 使用气泡标注重要元素
- 保持画布内容清晰可见

### ⚡ 性能优化
- 选择合适的输出尺寸
- 根据需求调整质量设置
- 避免频繁重复生成

## 扩展功能

### 🔮 未来计划
- 支持更多AI模型
- 批量生成功能
- 历史记录管理
- 样式预设模板

### 🛠 自定义扩展
AILoadingRect组件设计为可扩展架构，支持：
- 自定义加载动画
- 多种输出格式
- 插件式功能扩展

## 技术支持

如遇到问题，请：
1. 查看浏览器控制台错误信息
2. 确认API服务状态
3. 检查网络连接
4. 联系技术支持

---

**享受AI创作的乐趣！** ✨🎨
